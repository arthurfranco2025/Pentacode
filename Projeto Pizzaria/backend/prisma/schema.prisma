generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Funcionario {
  id         String    @id @default(uuid())
  name       String
  funcao     String
  email      String
  password   String
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  @@map("funcionarios")
}

model Cliente {
  id         String      @id @default(uuid())
  name       String
  email      String
  password   String
  cpf        String
  data_nasc  DateTime?
  created_at DateTime?   @default(now())
  updated_at DateTime?   @default(now())
  points     Float       @default(0)
  image_url  String?
  avaliacao  Avaliacao[]
  comandas   Comanda[]
  favoritos  Favorito[]
  pedidos    Pedido[]

  @@map("clientes")
}

model Favorito {
  id         String    @id @default(uuid())
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())
  product_id String
  cliente_id String
  cliente    Cliente   @relation(fields: [cliente_id], references: [id])
  product    Product   @relation(fields: [product_id], references: [id])

  @@map("favorites")
}

model Category {
  id         String    @id @default(uuid())
  name       String
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())
  image_url  String?
  products   Product[]

  @@map("categories")
}

model Product {
  id                  String                @id @default(uuid())
  name                String
  price               Float
  points              Float
  description         String
  promocao            Boolean
  created_at          DateTime?             @default(now())
  updated_at          DateTime?             @default(now())
  category_id         String
  image_url           String?
  favoritos           Favorito[]
  sabor2_items        Item[]                @relation("Sabor2")
  sabor1_items        Item[]                @relation("Sabor1")
  product_ingrediente Product_ingrediente[]
  category            Category              @relation(fields: [category_id], references: [id])

  @@map("products")
}

model Pedido {
  id         String    @id @default(uuid())
  status     String
  price      Float
  points     Float
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())
  cliente_id String
  comanda_id String
  items      Item[]
  cliente    Cliente   @relation(fields: [cliente_id], references: [id])
  comanda    Comanda   @relation(fields: [comanda_id], references: [id])

  @@map("pedidos")
}

model Comanda {
  id            String      @id @default(uuid())
  status        String
  price         Float
  points        Float
  created_at    DateTime?   @default(now())
  updated_at    DateTime?   @default(now())
  cliente_id    String
  mesa_id       String?
  pagoEm        DateTime?
  tipoPagamento String?
  pontosPagos   Float?
  avaliacao     Avaliacao[]
  cliente       Cliente     @relation(fields: [cliente_id], references: [id])
  mesa          Mesa?       @relation(fields: [mesa_id], references: [id])
  pedido        Pedido[]

  @@map("comandas")
}

model Avaliacao {
  id         String    @id @default(uuid())
  nota       Int
  descricao  String
  created_at DateTime? @default(now())
  cliente_id String
  comanda_id String
  cliente    Cliente   @relation(fields: [cliente_id], references: [id])
  comanda    Comanda   @relation(fields: [comanda_id], references: [id])

  @@map("avaliacoes")
}

model Item {
  id             String           @id @default(uuid())
  qtd            Int
  created_at     DateTime?        @default(now())
  updated_at     DateTime?        @default(now())
  product_id     String
  pedido_id      String
  price          Float
  points         Float            @default(0)
  removidos      Json?
  adicionais     Json?
  observacoes    String?
  dois_sabores   Boolean          @default(false)
  product2_id    String?
  status         String           @default("")
  payWithPoints  Boolean?         @default(false)
  Item_adicional Item_adicional[]
  pedido         Pedido           @relation(fields: [pedido_id], references: [id])
  product2       Product?         @relation("Sabor2", fields: [product2_id], references: [id])
  product        Product          @relation("Sabor1", fields: [product_id], references: [id])

  @@map("items")
}

model Ingrediente {
  id                  String                @id @default(uuid())
  nome                String
  price               Float
  created_at          DateTime?             @default(now())
  updated_at          DateTime?             @default(now())
  Product_ingrediente Product_ingrediente[]

  @@map("ingredientes")
}

model Product_ingrediente {
  id             String      @id @default(uuid())
  created_at     DateTime?   @default(now())
  updated_at     DateTime?   @default(now())
  product_id     String
  ingrediente_id String
  qtd            Boolean     @default(true)
  ingrediente    Ingrediente @relation(fields: [ingrediente_id], references: [id])
  product        Product     @relation(fields: [product_id], references: [id])

  @@map("product_ingrediente")
}

model Adicional {
  id             String           @id @default(uuid())
  nome           String
  price          Float
  created_at     DateTime?        @default(now())
  updated_at     DateTime?        @default(now())
  points         Float            @default(0)
  Item_adicional Item_adicional[]

  @@map("adicionais")
}

model Item_adicional {
  id           String    @id @default(uuid())
  item_id      String
  adicional_id String
  qtd          Int       @default(1)
  adicional    Adicional @relation(fields: [adicional_id], references: [id])
  item         Item      @relation(fields: [item_id], references: [id])

  @@map("item_adicional")
}

model Mesa {
  id          String    @id @default(uuid())
  numero_mesa Int       @unique
  created_at  DateTime? @default(now())
  updated_at  DateTime? @default(now())
  url         String    @default("")
  Comanda     Comanda[]

  @@map("mesas")
}
