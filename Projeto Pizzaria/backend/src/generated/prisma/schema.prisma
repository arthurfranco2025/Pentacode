generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Funcionario {
  id         String    @id @default(uuid())
  name       String
  funcao     String
  email      String
  password   String
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  @@map("funcionarios")
}

model Cliente {
  id         String    @id @default(uuid())
  name       String
  email      String
  password   String
  cpf        String
  data_nasc  DateTime?
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  avaliacao Avaliacao[]
  favoritos Favorito[]
  comandas  Comanda[]
  pedidos   Pedido[]

  @@map("clientes")
}

model Favorito {
  id         String    @id @default(uuid())
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  product    Product @relation(fields: [product_id], references: [id])
  product_id String

  cliente    Cliente @relation(fields: [cliente_id], references: [id])
  cliente_id String

  @@map("favorites")
}

model Category {
  id         String    @id @default(uuid())
  name       String
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  products Product[]

  @@map("categories")
}

model Product {
  id          String    @id @default(uuid())
  name        String
  price       Float
  points      Float
  description String
  promocao    Boolean
  image_url   String?
  created_at  DateTime? @default(now())
  updated_at  DateTime? @default(now())

  category    Category @relation(fields: [category_id], references: [id])
  category_id String

  items               Item[]
  favoritos           Favorito[]
  product_ingrediente Product_ingrediente[]

  @@map("products")
}

model Pedido {
  id         String    @id @default(uuid())
  status     String
  price      Float
  points     Float
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  cliente    Cliente @relation(fields: [cliente_id], references: [id])
  cliente_id String
  comanda    Comanda @relation(fields: [comanda_id], references: [id])
  comanda_id String

  items Item[]

  @@map("pedidos")
}

model Comanda {
  id         String    @id @default(uuid())
  status     String
  price      Int
  points     Int
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  cliente    Cliente @relation(fields: [cliente_id], references: [id])
  cliente_id String

  avaliacao Avaliacao[]
  pedido    Pedido[]

  @@map("comandas")
}

model Avaliacao {
  id         String    @id @default(uuid())
  nota       Int
  descricao  String
  created_at DateTime? @default(now())

  cliente    Cliente @relation(fields: [cliente_id], references: [id])
  comanda    Comanda @relation(fields: [comanda_id], references: [id])
  cliente_id String
  comanda_id String

  @@map("avaliacoes")
}

model Item {
  id         String    @id @default(uuid())
  qtd        Int
  price      Float
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  pedido  Pedido  @relation(fields: [pedido_id], references: [id])
  product Product @relation(fields: [product_id], references: [id])

  pedido_id  String
  product_id String

  Item_adicional Item_adicional[]

  @@map("items")
}

model Ingrediente {
  id         String    @id @default(uuid())
  nome       String
  price      Float
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  Product_ingrediente Product_ingrediente[]

  @@map("ingredientes")
}

model Product_ingrediente {
  id         String    @id @default(uuid())
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  product    Product @relation(fields: [product_id], references: [id])
  product_id String

  ingrediente    Ingrediente @relation(fields: [ingrediente_id], references: [id])
  ingrediente_id String

  @@map("product_ingrediente")
}

model Adicional {
  id         String    @id @default(uuid())
  nome       String
  price      Float
  created_at DateTime? @default(now())
  updated_at DateTime? @default(now())

  Item_adicional Item_adicional[]

  @@map("adicionais")
}

model Item_adicional {
  id String @id @default(uuid())

  item    Item   @relation(fields: [item_id], references: [id])
  item_id String

  adicional    Adicional @relation(fields: [adicional_id], references: [id])
  adicional_id String

  @@map("item_adicional")
}
